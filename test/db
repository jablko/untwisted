#!/usr/bin/env python

import untwisted
from testify import *
from untwisted import db

expect(7)

class module:
  class connect:
    def __init__(ctx, *args, **kwds):
      equal(('First', 'Second', 'Third'), args)
      equal({ 'First': 'Tsrif', 'Second': 'Dnoces', 'Third': 'Driht', 'module': module }, kwds)

    class cursor:
      def __init__(ctx):
        ok(True)

      close = untwisted.partial(ok, True)

      def execute(ctx, operation, params):
        equal('Expect', operation)
        equal((), params)

      fetchone = lambda ctx: 'Expect'

conn = db.connect('First', 'Second', 'Third', First='Tsrif', Second='Dnoces', Third='Driht', module=module)
cursor = conn.cursor()
cursor.close()
cursor.execute('Expect')
equal('Expect', cursor.fetchone())

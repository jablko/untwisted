#!/usr/bin/env python

import functools
from testify import *
from untwisted import promise

@test
def now():
  expect(1)

  sample = promise.promise()
  sample('Expect')

  promise.nowThen(sample,
    functools.partial(equal, 'Expect'),
    functools.partial(ok, False))

@test
def then():
  expect(1)

  sample = promise.promise()

  promise.nowThen(sample,
    functools.partial(ok, False),
    functools.partial(equal, 'Expect'))

  sample('Expect')

def noNow():
  expect(1)

  sample = promise.promise()
  sample('Expect')
  promise.nowThen(sample)

  sample.then(functools.partial(equal, 'Expect'))

test(noNow)
test(noNow)

def noThen():
  expect(1)

  sample = promise.promise()
  promise.nowThen(sample)
  sample('Expect')

  sample.then(functools.partial(equal, 'Expect'))

test(noThen)
test(noThen)
